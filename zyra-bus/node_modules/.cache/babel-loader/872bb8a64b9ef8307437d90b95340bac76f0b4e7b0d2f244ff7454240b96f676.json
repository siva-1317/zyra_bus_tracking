{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\sathy\\\\OneDrive\\\\Desktop\\\\bus-app\\\\zyra-bus\\\\src\\\\pages\\\\driver\\\\DriverTrackingPage.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { useEffect, useRef, useState } from \"react\";\nimport { Container, Card, Button, Badge, Row, Col, Alert } from \"react-bootstrap\";\nimport { MapContainer, TileLayer, Marker, Popup, Polyline, useMap } from \"react-leaflet\";\nimport API from \"../../api\";\nimport L from \"leaflet\";\nimport \"leaflet/dist/leaflet.css\";\nimport busImage from \"../../assets/bus.png\";\n\n/* ================= FIX DEFAULT MARKER ================= */\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: \"https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon-2x.png\",\n  iconUrl: \"https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon.png\",\n  shadowUrl: \"https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png\"\n});\n\n/* ================= ICONS ================= */\nconst stopIcon = new L.Icon({\n  iconUrl: \"https://cdn-icons-png.flaticon.com/512/684/684908.png\",\n  iconSize: [25, 25],\n  iconAnchor: [12, 25]\n});\nconst busIcon = new L.Icon({\n  iconUrl: busImage,\n  iconSize: [40, 40],\n  iconAnchor: [20, 20]\n});\n\n/* ================= AUTO CENTER ================= */\nfunction RecenterMap({\n  location\n}) {\n  _s();\n  const map = useMap();\n  useEffect(() => {\n    if (location) {\n      map.setView([location.lat, location.lng], 15);\n    }\n  }, [location, map]);\n  return null;\n}\n_s(RecenterMap, \"IoceErwr5KVGS9kN4RQ1bOkYMAg=\", false, function () {\n  return [useMap];\n});\n_c = RecenterMap;\nexport default function DriverTrackingPage() {\n  _s2();\n  const [trip, setTrip] = useState(null);\n  const [bus, setBus] = useState(null);\n  const [location, setLocation] = useState(null);\n  const [status, setStatus] = useState(\"loading\");\n  const [routeCoords, setRouteCoords] = useState([]);\n  const watchRef = useRef(null);\n  const previousLocation = useRef(null);\n  const animationRef = useRef(null);\n\n  /* ================= ANIMATION ================= */\n  const animateMovement = newLoc => {\n    if (!previousLocation.current) {\n      previousLocation.current = newLoc;\n      setLocation(newLoc);\n      return;\n    }\n    if (animationRef.current) {\n      cancelAnimationFrame(animationRef.current);\n    }\n    const start = previousLocation.current;\n    const end = newLoc;\n    const duration = 1000;\n    const startTime = performance.now();\n    const animate = time => {\n      const progress = Math.min((time - startTime) / duration, 1);\n      const lat = start.lat + (end.lat - start.lat) * progress;\n      const lng = start.lng + (end.lng - start.lng) * progress;\n      setLocation({\n        lat,\n        lng\n      });\n      if (progress < 1) {\n        animationRef.current = requestAnimationFrame(animate);\n      } else {\n        previousLocation.current = newLoc;\n      }\n    };\n    animationRef.current = requestAnimationFrame(animate);\n  };\n\n  /* ================= FETCH ACTIVE TRIP ================= */\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const res = await API.get(\"/driver/active-trip\");\n        setTrip(res.data.trip);\n        setBus(res.data.bus);\n        if (res.data.trip) {\n          setStatus(res.data.trip.status);\n          if (res.data.trip.status === \"running\") {\n            startGPS(res.data.trip._id);\n          }\n        } else {\n          setStatus(\"idle\");\n        }\n      } catch {\n        setStatus(\"idle\");\n      }\n    };\n    fetchData();\n  }, []);\n\n  /* ================= ROUTE LOGIC ================= */\n  useEffect(() => {\n    if (!bus) return;\n    const fetchRoute = async () => {\n      try {\n        let route = [];\n\n        // ðŸ”¥ EVENT TRIP\n        if ((trip === null || trip === void 0 ? void 0 : trip.tripType) === \"event\" && trip.destinationLat) {\n          var _data$routes;\n          const start = bus.stops[0];\n          const url = `https://router.project-osrm.org/route/v1/driving/${start.lng},${start.lat};${trip.destinationLng},${trip.destinationLat}?overview=full&geometries=geojson`;\n          const res = await fetch(url);\n          const data = await res.json();\n          if (((_data$routes = data.routes) === null || _data$routes === void 0 ? void 0 : _data$routes.length) > 0) {\n            route = data.routes[0].geometry.coordinates.map(c => [c[1], c[0]]);\n          }\n        } else {\n          // ðŸ”¥ NORMAL ROUTE\n          for (let i = 0; i < bus.stops.length - 1; i++) {\n            var _data$routes2;\n            const start = bus.stops[i];\n            const end = bus.stops[i + 1];\n            const url = `https://router.project-osrm.org/route/v1/driving/${start.lng},${start.lat};${end.lng},${end.lat}?overview=full&geometries=geojson`;\n            const res = await fetch(url);\n            const data = await res.json();\n            if (((_data$routes2 = data.routes) === null || _data$routes2 === void 0 ? void 0 : _data$routes2.length) > 0) {\n              const segment = data.routes[0].geometry.coordinates.map(c => [c[1], c[0]]);\n              route = [...route, ...segment];\n            }\n          }\n        }\n        setRouteCoords(route);\n      } catch {\n        console.log(\"Route load failed\");\n      }\n    };\n    fetchRoute();\n  }, [trip, bus]);\n\n  /* ================= GPS ================= */\n  const startGPS = id => {\n    if (!navigator.geolocation) return;\n    watchRef.current = navigator.geolocation.watchPosition(async pos => {\n      const newLoc = {\n        lat: pos.coords.latitude,\n        lng: pos.coords.longitude\n      };\n      animateMovement(newLoc);\n      await API.post(`/driver/trip/${id}/location`, newLoc);\n    }, err => console.log(err), {\n      enableHighAccuracy: true\n    });\n  };\n  const stopGPS = () => {\n    if (watchRef.current) {\n      navigator.geolocation.clearWatch(watchRef.current);\n    }\n  };\n\n  /* ================= CONTROLS ================= */\n  const startTrip = async () => {\n    await API.post(`/driver/trip/${trip._id}/start`);\n    setStatus(\"running\");\n    startGPS(trip._id);\n  };\n  const endTrip = async () => {\n    try {\n      await API.post(`/driver/trip/${trip._id}/end`);\n      stopGPS();\n      previousLocation.current = null;\n\n      // ðŸ”¥ After event completed, check for next trip\n      const res = await API.get(\"/driver/active-trip\");\n      if (res.data.trip) {\n        setTrip(res.data.trip);\n        setStatus(res.data.trip.status);\n      } else {\n        setTrip(null);\n        setStatus(\"idle\");\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  };\n  if (!bus) {\n    return /*#__PURE__*/_jsxDEV(Container, {\n      className: \"mt-4\",\n      children: /*#__PURE__*/_jsxDEV(Alert, {\n        variant: \"warning\",\n        children: \"No bus assigned.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(Container, {\n    className: \"mt-4\",\n    children: [/*#__PURE__*/_jsxDEV(Card, {\n      className: \"shadow-lg p-4 mb-4\",\n      children: [/*#__PURE__*/_jsxDEV(Row, {\n        children: [/*#__PURE__*/_jsxDEV(Col, {\n          md: 8,\n          children: /*#__PURE__*/_jsxDEV(\"h4\", {\n            children: [\"Driver Tracking - \", bus.busNo]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 251,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Col, {\n          md: 4,\n          className: \"text-end\",\n          children: /*#__PURE__*/_jsxDEV(Badge, {\n            bg: \"info\",\n            children: status === null || status === void 0 ? void 0 : status.toUpperCase()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 254,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 9\n      }, this), status === \"planned\" && /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"success\",\n        onClick: startTrip,\n        children: \"Start Trip\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 11\n      }, this), status === \"running\" && /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"danger\",\n        onClick: endTrip,\n        children: \"End Trip\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Card, {\n      className: \"shadow-lg p-3\",\n      children: /*#__PURE__*/_jsxDEV(MapContainer, {\n        center: routeCoords.length ? routeCoords[0] : [bus.stops[0].lat, bus.stops[0].lng],\n        zoom: 14,\n        style: {\n          height: \"500px\",\n          width: \"100%\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n          attribution: \"\\xA9 OpenStreetMap contributors\",\n          url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 11\n        }, this), routeCoords.length > 0 && /*#__PURE__*/_jsxDEV(Polyline, {\n          positions: routeCoords,\n          color: \"blue\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 287,\n          columnNumber: 13\n        }, this), (trip === null || trip === void 0 ? void 0 : trip.tripType) !== \"event\" && bus.stops.map((stop, i) => /*#__PURE__*/_jsxDEV(Marker, {\n          position: [stop.lat, stop.lng],\n          icon: stopIcon,\n          children: /*#__PURE__*/_jsxDEV(Popup, {\n            children: stop.stopName\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 294,\n            columnNumber: 17\n          }, this)\n        }, i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 293,\n          columnNumber: 15\n        }, this)), location && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(Marker, {\n            position: [location.lat, location.lng],\n            icon: busIcon,\n            children: /*#__PURE__*/_jsxDEV(Popup, {\n              children: \"Live Bus\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 301,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 300,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(RecenterMap, {\n            location: location\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 303,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 272,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 247,\n    columnNumber: 5\n  }, this);\n}\n_s2(DriverTrackingPage, \"BMCySZLztlizMlQkmuf1G3wNgk0=\");\n_c2 = DriverTrackingPage;\nvar _c, _c2;\n$RefreshReg$(_c, \"RecenterMap\");\n$RefreshReg$(_c2, \"DriverTrackingPage\");","map":{"version":3,"names":["useEffect","useRef","useState","Container","Card","Button","Badge","Row","Col","Alert","MapContainer","TileLayer","Marker","Popup","Polyline","useMap","API","L","busImage","jsxDEV","_jsxDEV","Fragment","_Fragment","Icon","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","iconUrl","shadowUrl","stopIcon","iconSize","iconAnchor","busIcon","RecenterMap","location","_s","map","setView","lat","lng","_c","DriverTrackingPage","_s2","trip","setTrip","bus","setBus","setLocation","status","setStatus","routeCoords","setRouteCoords","watchRef","previousLocation","animationRef","animateMovement","newLoc","current","cancelAnimationFrame","start","end","duration","startTime","performance","now","animate","time","progress","Math","min","requestAnimationFrame","fetchData","res","get","data","startGPS","_id","fetchRoute","route","tripType","destinationLat","_data$routes","stops","url","destinationLng","fetch","json","routes","length","geometry","coordinates","c","i","_data$routes2","segment","console","log","id","navigator","geolocation","watchPosition","pos","coords","latitude","longitude","post","err","enableHighAccuracy","stopGPS","clearWatch","startTrip","endTrip","className","children","variant","fileName","_jsxFileName","lineNumber","columnNumber","md","busNo","bg","toUpperCase","onClick","center","zoom","style","height","width","attribution","positions","color","stop","position","icon","stopName","_c2","$RefreshReg$"],"sources":["C:/Users/sathy/OneDrive/Desktop/bus-app/zyra-bus/src/pages/driver/DriverTrackingPage.js"],"sourcesContent":["import { useEffect, useRef, useState } from \"react\";\r\nimport {\r\n  Container,\r\n  Card,\r\n  Button,\r\n  Badge,\r\n  Row,\r\n  Col,\r\n  Alert,\r\n} from \"react-bootstrap\";\r\nimport {\r\n  MapContainer,\r\n  TileLayer,\r\n  Marker,\r\n  Popup,\r\n  Polyline,\r\n  useMap,\r\n} from \"react-leaflet\";\r\nimport API from \"../../api\";\r\n\r\nimport L from \"leaflet\";\r\nimport \"leaflet/dist/leaflet.css\";\r\nimport busImage from \"../../assets/bus.png\";\r\n\r\n/* ================= FIX DEFAULT MARKER ================= */\r\ndelete L.Icon.Default.prototype._getIconUrl;\r\nL.Icon.Default.mergeOptions({\r\n  iconRetinaUrl:\r\n    \"https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon-2x.png\",\r\n  iconUrl:\r\n    \"https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon.png\",\r\n  shadowUrl:\r\n    \"https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png\",\r\n});\r\n\r\n/* ================= ICONS ================= */\r\nconst stopIcon = new L.Icon({\r\n  iconUrl: \"https://cdn-icons-png.flaticon.com/512/684/684908.png\",\r\n  iconSize: [25, 25],\r\n  iconAnchor: [12, 25],\r\n});\r\n\r\nconst busIcon = new L.Icon({\r\n  iconUrl: busImage,\r\n  iconSize: [40, 40],\r\n  iconAnchor: [20, 20],\r\n});\r\n\r\n/* ================= AUTO CENTER ================= */\r\nfunction RecenterMap({ location }) {\r\n  const map = useMap();\r\n  useEffect(() => {\r\n    if (location) {\r\n      map.setView([location.lat, location.lng], 15);\r\n    }\r\n  }, [location, map]);\r\n  return null;\r\n}\r\n\r\nexport default function DriverTrackingPage() {\r\n  const [trip, setTrip] = useState(null);\r\n  const [bus, setBus] = useState(null);\r\n  const [location, setLocation] = useState(null);\r\n  const [status, setStatus] = useState(\"loading\");\r\n  const [routeCoords, setRouteCoords] = useState([]);\r\n\r\n  const watchRef = useRef(null);\r\n  const previousLocation = useRef(null);\r\n  const animationRef = useRef(null);\r\n\r\n  /* ================= ANIMATION ================= */\r\n  const animateMovement = (newLoc) => {\r\n    if (!previousLocation.current) {\r\n      previousLocation.current = newLoc;\r\n      setLocation(newLoc);\r\n      return;\r\n    }\r\n\r\n    if (animationRef.current) {\r\n      cancelAnimationFrame(animationRef.current);\r\n    }\r\n\r\n    const start = previousLocation.current;\r\n    const end = newLoc;\r\n    const duration = 1000;\r\n    const startTime = performance.now();\r\n\r\n    const animate = (time) => {\r\n      const progress = Math.min((time - startTime) / duration, 1);\r\n      const lat = start.lat + (end.lat - start.lat) * progress;\r\n      const lng = start.lng + (end.lng - start.lng) * progress;\r\n\r\n      setLocation({ lat, lng });\r\n\r\n      if (progress < 1) {\r\n        animationRef.current = requestAnimationFrame(animate);\r\n      } else {\r\n        previousLocation.current = newLoc;\r\n      }\r\n    };\r\n\r\n    animationRef.current = requestAnimationFrame(animate);\r\n  };\r\n\r\n  /* ================= FETCH ACTIVE TRIP ================= */\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        const res = await API.get(\"/driver/active-trip\");\r\n        setTrip(res.data.trip);\r\n        setBus(res.data.bus);\r\n\r\n        if (res.data.trip) {\r\n          setStatus(res.data.trip.status);\r\n          if (res.data.trip.status === \"running\") {\r\n            startGPS(res.data.trip._id);\r\n          }\r\n        } else {\r\n          setStatus(\"idle\");\r\n        }\r\n      } catch {\r\n        setStatus(\"idle\");\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, []);\r\n\r\n  /* ================= ROUTE LOGIC ================= */\r\n  useEffect(() => {\r\n    if (!bus) return;\r\n\r\n    const fetchRoute = async () => {\r\n      try {\r\n        let route = [];\r\n\r\n        // ðŸ”¥ EVENT TRIP\r\n        if (trip?.tripType === \"event\" && trip.destinationLat) {\r\n          const start = bus.stops[0];\r\n\r\n          const url = `https://router.project-osrm.org/route/v1/driving/${start.lng},${start.lat};${trip.destinationLng},${trip.destinationLat}?overview=full&geometries=geojson`;\r\n\r\n          const res = await fetch(url);\r\n          const data = await res.json();\r\n\r\n          if (data.routes?.length > 0) {\r\n            route = data.routes[0].geometry.coordinates.map((c) => [\r\n              c[1],\r\n              c[0],\r\n            ]);\r\n          }\r\n        } else {\r\n          // ðŸ”¥ NORMAL ROUTE\r\n          for (let i = 0; i < bus.stops.length - 1; i++) {\r\n            const start = bus.stops[i];\r\n            const end = bus.stops[i + 1];\r\n\r\n            const url = `https://router.project-osrm.org/route/v1/driving/${start.lng},${start.lat};${end.lng},${end.lat}?overview=full&geometries=geojson`;\r\n\r\n            const res = await fetch(url);\r\n            const data = await res.json();\r\n\r\n            if (data.routes?.length > 0) {\r\n              const segment = data.routes[0].geometry.coordinates.map((c) => [\r\n                c[1],\r\n                c[0],\r\n              ]);\r\n              route = [...route, ...segment];\r\n            }\r\n          }\r\n        }\r\n\r\n        setRouteCoords(route);\r\n      } catch {\r\n        console.log(\"Route load failed\");\r\n      }\r\n    };\r\n\r\n    fetchRoute();\r\n  }, [trip, bus]);\r\n\r\n  /* ================= GPS ================= */\r\n  const startGPS = (id) => {\r\n    if (!navigator.geolocation) return;\r\n\r\n    watchRef.current = navigator.geolocation.watchPosition(\r\n      async (pos) => {\r\n        const newLoc = {\r\n          lat: pos.coords.latitude,\r\n          lng: pos.coords.longitude,\r\n        };\r\n\r\n        animateMovement(newLoc);\r\n\r\n        await API.post(`/driver/trip/${id}/location`, newLoc);\r\n      },\r\n      (err) => console.log(err),\r\n      { enableHighAccuracy: true }\r\n    );\r\n  };\r\n\r\n  const stopGPS = () => {\r\n    if (watchRef.current) {\r\n      navigator.geolocation.clearWatch(watchRef.current);\r\n    }\r\n  };\r\n\r\n  /* ================= CONTROLS ================= */\r\n  const startTrip = async () => {\r\n    await API.post(`/driver/trip/${trip._id}/start`);\r\n    setStatus(\"running\");\r\n    startGPS(trip._id);\r\n  };\r\n\r\nconst endTrip = async () => {\r\n  try {\r\n    await API.post(`/driver/trip/${trip._id}/end`);\r\n\r\n    stopGPS();\r\n    previousLocation.current = null;\r\n\r\n    // ðŸ”¥ After event completed, check for next trip\r\n    const res = await API.get(\"/driver/active-trip\");\r\n\r\n    if (res.data.trip) {\r\n      setTrip(res.data.trip);\r\n      setStatus(res.data.trip.status);\r\n    } else {\r\n      setTrip(null);\r\n      setStatus(\"idle\");\r\n    }\r\n\r\n  } catch (err) {\r\n    console.log(err);\r\n  }\r\n};\r\n\r\n  if (!bus) {\r\n    return (\r\n      <Container className=\"mt-4\">\r\n        <Alert variant=\"warning\">No bus assigned.</Alert>\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Container className=\"mt-4\">\r\n      <Card className=\"shadow-lg p-4 mb-4\">\r\n        <Row>\r\n          <Col md={8}>\r\n            <h4>Driver Tracking - {bus.busNo}</h4>\r\n          </Col>\r\n          <Col md={4} className=\"text-end\">\r\n            <Badge bg=\"info\">{status?.toUpperCase()}</Badge>\r\n          </Col>\r\n        </Row>\r\n\r\n        {status === \"planned\" && (\r\n          <Button variant=\"success\" onClick={startTrip}>\r\n            Start Trip\r\n          </Button>\r\n        )}\r\n\r\n        {status === \"running\" && (\r\n          <Button variant=\"danger\" onClick={endTrip}>\r\n            End Trip\r\n          </Button>\r\n        )}\r\n      </Card>\r\n\r\n      <Card className=\"shadow-lg p-3\">\r\n        <MapContainer\r\n          center={\r\n            routeCoords.length\r\n              ? routeCoords[0]\r\n              : [bus.stops[0].lat, bus.stops[0].lng]\r\n          }\r\n          zoom={14}\r\n          style={{ height: \"500px\", width: \"100%\" }}\r\n        >\r\n          <TileLayer\r\n            attribution=\"Â© OpenStreetMap contributors\"\r\n            url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n          />\r\n\r\n          {routeCoords.length > 0 && (\r\n            <Polyline positions={routeCoords} color=\"blue\" />\r\n          )}\r\n\r\n          {/* Show stops only for normal route */}\r\n          {trip?.tripType !== \"event\" &&\r\n            bus.stops.map((stop, i) => (\r\n              <Marker key={i} position={[stop.lat, stop.lng]} icon={stopIcon}>\r\n                <Popup>{stop.stopName}</Popup>\r\n              </Marker>\r\n            ))}\r\n\r\n          {location && (\r\n            <>\r\n              <Marker position={[location.lat, location.lng]} icon={busIcon}>\r\n                <Popup>Live Bus</Popup>\r\n              </Marker>\r\n              <RecenterMap location={location} />\r\n            </>\r\n          )}\r\n        </MapContainer>\r\n      </Card>\r\n    </Container>\r\n  );\r\n}"],"mappings":";;;AAAA,SAASA,SAAS,EAAEC,MAAM,EAAEC,QAAQ,QAAQ,OAAO;AACnD,SACEC,SAAS,EACTC,IAAI,EACJC,MAAM,EACNC,KAAK,EACLC,GAAG,EACHC,GAAG,EACHC,KAAK,QACA,iBAAiB;AACxB,SACEC,YAAY,EACZC,SAAS,EACTC,MAAM,EACNC,KAAK,EACLC,QAAQ,EACRC,MAAM,QACD,eAAe;AACtB,OAAOC,GAAG,MAAM,WAAW;AAE3B,OAAOC,CAAC,MAAM,SAAS;AACvB,OAAO,0BAA0B;AACjC,OAAOC,QAAQ,MAAM,sBAAsB;;AAE3C;AAAA,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AACA,OAAOL,CAAC,CAACM,IAAI,CAACC,OAAO,CAACC,SAAS,CAACC,WAAW;AAC3CT,CAAC,CAACM,IAAI,CAACC,OAAO,CAACG,YAAY,CAAC;EAC1BC,aAAa,EACX,gEAAgE;EAClEC,OAAO,EACL,6DAA6D;EAC/DC,SAAS,EACP;AACJ,CAAC,CAAC;;AAEF;AACA,MAAMC,QAAQ,GAAG,IAAId,CAAC,CAACM,IAAI,CAAC;EAC1BM,OAAO,EAAE,uDAAuD;EAChEG,QAAQ,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;EAClBC,UAAU,EAAE,CAAC,EAAE,EAAE,EAAE;AACrB,CAAC,CAAC;AAEF,MAAMC,OAAO,GAAG,IAAIjB,CAAC,CAACM,IAAI,CAAC;EACzBM,OAAO,EAAEX,QAAQ;EACjBc,QAAQ,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;EAClBC,UAAU,EAAE,CAAC,EAAE,EAAE,EAAE;AACrB,CAAC,CAAC;;AAEF;AACA,SAASE,WAAWA,CAAC;EAAEC;AAAS,CAAC,EAAE;EAAAC,EAAA;EACjC,MAAMC,GAAG,GAAGvB,MAAM,CAAC,CAAC;EACpBf,SAAS,CAAC,MAAM;IACd,IAAIoC,QAAQ,EAAE;MACZE,GAAG,CAACC,OAAO,CAAC,CAACH,QAAQ,CAACI,GAAG,EAAEJ,QAAQ,CAACK,GAAG,CAAC,EAAE,EAAE,CAAC;IAC/C;EACF,CAAC,EAAE,CAACL,QAAQ,EAAEE,GAAG,CAAC,CAAC;EACnB,OAAO,IAAI;AACb;AAACD,EAAA,CARQF,WAAW;EAAA,QACNpB,MAAM;AAAA;AAAA2B,EAAA,GADXP,WAAW;AAUpB,eAAe,SAASQ,kBAAkBA,CAAA,EAAG;EAAAC,GAAA;EAC3C,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAG5C,QAAQ,CAAC,IAAI,CAAC;EACtC,MAAM,CAAC6C,GAAG,EAAEC,MAAM,CAAC,GAAG9C,QAAQ,CAAC,IAAI,CAAC;EACpC,MAAM,CAACkC,QAAQ,EAAEa,WAAW,CAAC,GAAG/C,QAAQ,CAAC,IAAI,CAAC;EAC9C,MAAM,CAACgD,MAAM,EAAEC,SAAS,CAAC,GAAGjD,QAAQ,CAAC,SAAS,CAAC;EAC/C,MAAM,CAACkD,WAAW,EAAEC,cAAc,CAAC,GAAGnD,QAAQ,CAAC,EAAE,CAAC;EAElD,MAAMoD,QAAQ,GAAGrD,MAAM,CAAC,IAAI,CAAC;EAC7B,MAAMsD,gBAAgB,GAAGtD,MAAM,CAAC,IAAI,CAAC;EACrC,MAAMuD,YAAY,GAAGvD,MAAM,CAAC,IAAI,CAAC;;EAEjC;EACA,MAAMwD,eAAe,GAAIC,MAAM,IAAK;IAClC,IAAI,CAACH,gBAAgB,CAACI,OAAO,EAAE;MAC7BJ,gBAAgB,CAACI,OAAO,GAAGD,MAAM;MACjCT,WAAW,CAACS,MAAM,CAAC;MACnB;IACF;IAEA,IAAIF,YAAY,CAACG,OAAO,EAAE;MACxBC,oBAAoB,CAACJ,YAAY,CAACG,OAAO,CAAC;IAC5C;IAEA,MAAME,KAAK,GAAGN,gBAAgB,CAACI,OAAO;IACtC,MAAMG,GAAG,GAAGJ,MAAM;IAClB,MAAMK,QAAQ,GAAG,IAAI;IACrB,MAAMC,SAAS,GAAGC,WAAW,CAACC,GAAG,CAAC,CAAC;IAEnC,MAAMC,OAAO,GAAIC,IAAI,IAAK;MACxB,MAAMC,QAAQ,GAAGC,IAAI,CAACC,GAAG,CAAC,CAACH,IAAI,GAAGJ,SAAS,IAAID,QAAQ,EAAE,CAAC,CAAC;MAC3D,MAAMvB,GAAG,GAAGqB,KAAK,CAACrB,GAAG,GAAG,CAACsB,GAAG,CAACtB,GAAG,GAAGqB,KAAK,CAACrB,GAAG,IAAI6B,QAAQ;MACxD,MAAM5B,GAAG,GAAGoB,KAAK,CAACpB,GAAG,GAAG,CAACqB,GAAG,CAACrB,GAAG,GAAGoB,KAAK,CAACpB,GAAG,IAAI4B,QAAQ;MAExDpB,WAAW,CAAC;QAAET,GAAG;QAAEC;MAAI,CAAC,CAAC;MAEzB,IAAI4B,QAAQ,GAAG,CAAC,EAAE;QAChBb,YAAY,CAACG,OAAO,GAAGa,qBAAqB,CAACL,OAAO,CAAC;MACvD,CAAC,MAAM;QACLZ,gBAAgB,CAACI,OAAO,GAAGD,MAAM;MACnC;IACF,CAAC;IAEDF,YAAY,CAACG,OAAO,GAAGa,qBAAqB,CAACL,OAAO,CAAC;EACvD,CAAC;;EAED;EACAnE,SAAS,CAAC,MAAM;IACd,MAAMyE,SAAS,GAAG,MAAAA,CAAA,KAAY;MAC5B,IAAI;QACF,MAAMC,GAAG,GAAG,MAAM1D,GAAG,CAAC2D,GAAG,CAAC,qBAAqB,CAAC;QAChD7B,OAAO,CAAC4B,GAAG,CAACE,IAAI,CAAC/B,IAAI,CAAC;QACtBG,MAAM,CAAC0B,GAAG,CAACE,IAAI,CAAC7B,GAAG,CAAC;QAEpB,IAAI2B,GAAG,CAACE,IAAI,CAAC/B,IAAI,EAAE;UACjBM,SAAS,CAACuB,GAAG,CAACE,IAAI,CAAC/B,IAAI,CAACK,MAAM,CAAC;UAC/B,IAAIwB,GAAG,CAACE,IAAI,CAAC/B,IAAI,CAACK,MAAM,KAAK,SAAS,EAAE;YACtC2B,QAAQ,CAACH,GAAG,CAACE,IAAI,CAAC/B,IAAI,CAACiC,GAAG,CAAC;UAC7B;QACF,CAAC,MAAM;UACL3B,SAAS,CAAC,MAAM,CAAC;QACnB;MACF,CAAC,CAAC,MAAM;QACNA,SAAS,CAAC,MAAM,CAAC;MACnB;IACF,CAAC;IAEDsB,SAAS,CAAC,CAAC;EACb,CAAC,EAAE,EAAE,CAAC;;EAEN;EACAzE,SAAS,CAAC,MAAM;IACd,IAAI,CAAC+C,GAAG,EAAE;IAEV,MAAMgC,UAAU,GAAG,MAAAA,CAAA,KAAY;MAC7B,IAAI;QACF,IAAIC,KAAK,GAAG,EAAE;;QAEd;QACA,IAAI,CAAAnC,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEoC,QAAQ,MAAK,OAAO,IAAIpC,IAAI,CAACqC,cAAc,EAAE;UAAA,IAAAC,YAAA;UACrD,MAAMtB,KAAK,GAAGd,GAAG,CAACqC,KAAK,CAAC,CAAC,CAAC;UAE1B,MAAMC,GAAG,GAAG,oDAAoDxB,KAAK,CAACpB,GAAG,IAAIoB,KAAK,CAACrB,GAAG,IAAIK,IAAI,CAACyC,cAAc,IAAIzC,IAAI,CAACqC,cAAc,mCAAmC;UAEvK,MAAMR,GAAG,GAAG,MAAMa,KAAK,CAACF,GAAG,CAAC;UAC5B,MAAMT,IAAI,GAAG,MAAMF,GAAG,CAACc,IAAI,CAAC,CAAC;UAE7B,IAAI,EAAAL,YAAA,GAAAP,IAAI,CAACa,MAAM,cAAAN,YAAA,uBAAXA,YAAA,CAAaO,MAAM,IAAG,CAAC,EAAE;YAC3BV,KAAK,GAAGJ,IAAI,CAACa,MAAM,CAAC,CAAC,CAAC,CAACE,QAAQ,CAACC,WAAW,CAACtD,GAAG,CAAEuD,CAAC,IAAK,CACrDA,CAAC,CAAC,CAAC,CAAC,EACJA,CAAC,CAAC,CAAC,CAAC,CACL,CAAC;UACJ;QACF,CAAC,MAAM;UACL;UACA,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG/C,GAAG,CAACqC,KAAK,CAACM,MAAM,GAAG,CAAC,EAAEI,CAAC,EAAE,EAAE;YAAA,IAAAC,aAAA;YAC7C,MAAMlC,KAAK,GAAGd,GAAG,CAACqC,KAAK,CAACU,CAAC,CAAC;YAC1B,MAAMhC,GAAG,GAAGf,GAAG,CAACqC,KAAK,CAACU,CAAC,GAAG,CAAC,CAAC;YAE5B,MAAMT,GAAG,GAAG,oDAAoDxB,KAAK,CAACpB,GAAG,IAAIoB,KAAK,CAACrB,GAAG,IAAIsB,GAAG,CAACrB,GAAG,IAAIqB,GAAG,CAACtB,GAAG,mCAAmC;YAE/I,MAAMkC,GAAG,GAAG,MAAMa,KAAK,CAACF,GAAG,CAAC;YAC5B,MAAMT,IAAI,GAAG,MAAMF,GAAG,CAACc,IAAI,CAAC,CAAC;YAE7B,IAAI,EAAAO,aAAA,GAAAnB,IAAI,CAACa,MAAM,cAAAM,aAAA,uBAAXA,aAAA,CAAaL,MAAM,IAAG,CAAC,EAAE;cAC3B,MAAMM,OAAO,GAAGpB,IAAI,CAACa,MAAM,CAAC,CAAC,CAAC,CAACE,QAAQ,CAACC,WAAW,CAACtD,GAAG,CAAEuD,CAAC,IAAK,CAC7DA,CAAC,CAAC,CAAC,CAAC,EACJA,CAAC,CAAC,CAAC,CAAC,CACL,CAAC;cACFb,KAAK,GAAG,CAAC,GAAGA,KAAK,EAAE,GAAGgB,OAAO,CAAC;YAChC;UACF;QACF;QAEA3C,cAAc,CAAC2B,KAAK,CAAC;MACvB,CAAC,CAAC,MAAM;QACNiB,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAC;MAClC;IACF,CAAC;IAEDnB,UAAU,CAAC,CAAC;EACd,CAAC,EAAE,CAAClC,IAAI,EAAEE,GAAG,CAAC,CAAC;;EAEf;EACA,MAAM8B,QAAQ,GAAIsB,EAAE,IAAK;IACvB,IAAI,CAACC,SAAS,CAACC,WAAW,EAAE;IAE5B/C,QAAQ,CAACK,OAAO,GAAGyC,SAAS,CAACC,WAAW,CAACC,aAAa,CACpD,MAAOC,GAAG,IAAK;MACb,MAAM7C,MAAM,GAAG;QACblB,GAAG,EAAE+D,GAAG,CAACC,MAAM,CAACC,QAAQ;QACxBhE,GAAG,EAAE8D,GAAG,CAACC,MAAM,CAACE;MAClB,CAAC;MAEDjD,eAAe,CAACC,MAAM,CAAC;MAEvB,MAAM1C,GAAG,CAAC2F,IAAI,CAAC,gBAAgBR,EAAE,WAAW,EAAEzC,MAAM,CAAC;IACvD,CAAC,EACAkD,GAAG,IAAKX,OAAO,CAACC,GAAG,CAACU,GAAG,CAAC,EACzB;MAAEC,kBAAkB,EAAE;IAAK,CAC7B,CAAC;EACH,CAAC;EAED,MAAMC,OAAO,GAAGA,CAAA,KAAM;IACpB,IAAIxD,QAAQ,CAACK,OAAO,EAAE;MACpByC,SAAS,CAACC,WAAW,CAACU,UAAU,CAACzD,QAAQ,CAACK,OAAO,CAAC;IACpD;EACF,CAAC;;EAED;EACA,MAAMqD,SAAS,GAAG,MAAAA,CAAA,KAAY;IAC5B,MAAMhG,GAAG,CAAC2F,IAAI,CAAC,gBAAgB9D,IAAI,CAACiC,GAAG,QAAQ,CAAC;IAChD3B,SAAS,CAAC,SAAS,CAAC;IACpB0B,QAAQ,CAAChC,IAAI,CAACiC,GAAG,CAAC;EACpB,CAAC;EAEH,MAAMmC,OAAO,GAAG,MAAAA,CAAA,KAAY;IAC1B,IAAI;MACF,MAAMjG,GAAG,CAAC2F,IAAI,CAAC,gBAAgB9D,IAAI,CAACiC,GAAG,MAAM,CAAC;MAE9CgC,OAAO,CAAC,CAAC;MACTvD,gBAAgB,CAACI,OAAO,GAAG,IAAI;;MAE/B;MACA,MAAMe,GAAG,GAAG,MAAM1D,GAAG,CAAC2D,GAAG,CAAC,qBAAqB,CAAC;MAEhD,IAAID,GAAG,CAACE,IAAI,CAAC/B,IAAI,EAAE;QACjBC,OAAO,CAAC4B,GAAG,CAACE,IAAI,CAAC/B,IAAI,CAAC;QACtBM,SAAS,CAACuB,GAAG,CAACE,IAAI,CAAC/B,IAAI,CAACK,MAAM,CAAC;MACjC,CAAC,MAAM;QACLJ,OAAO,CAAC,IAAI,CAAC;QACbK,SAAS,CAAC,MAAM,CAAC;MACnB;IAEF,CAAC,CAAC,OAAOyD,GAAG,EAAE;MACZX,OAAO,CAACC,GAAG,CAACU,GAAG,CAAC;IAClB;EACF,CAAC;EAEC,IAAI,CAAC7D,GAAG,EAAE;IACR,oBACE3B,OAAA,CAACjB,SAAS;MAAC+G,SAAS,EAAC,MAAM;MAAAC,QAAA,eACzB/F,OAAA,CAACX,KAAK;QAAC2G,OAAO,EAAC,SAAS;QAAAD,QAAA,EAAC;MAAgB;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAO;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACxC,CAAC;EAEhB;EAEA,oBACEpG,OAAA,CAACjB,SAAS;IAAC+G,SAAS,EAAC,MAAM;IAAAC,QAAA,gBACzB/F,OAAA,CAAChB,IAAI;MAAC8G,SAAS,EAAC,oBAAoB;MAAAC,QAAA,gBAClC/F,OAAA,CAACb,GAAG;QAAA4G,QAAA,gBACF/F,OAAA,CAACZ,GAAG;UAACiH,EAAE,EAAE,CAAE;UAAAN,QAAA,eACT/F,OAAA;YAAA+F,QAAA,GAAI,oBAAkB,EAACpE,GAAG,CAAC2E,KAAK;UAAA;YAAAL,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACnC,CAAC,eACNpG,OAAA,CAACZ,GAAG;UAACiH,EAAE,EAAE,CAAE;UAACP,SAAS,EAAC,UAAU;UAAAC,QAAA,eAC9B/F,OAAA,CAACd,KAAK;YAACqH,EAAE,EAAC,MAAM;YAAAR,QAAA,EAAEjE,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAE0E,WAAW,CAAC;UAAC;YAAAP,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC7C,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,EAELtE,MAAM,KAAK,SAAS,iBACnB9B,OAAA,CAACf,MAAM;QAAC+G,OAAO,EAAC,SAAS;QAACS,OAAO,EAAEb,SAAU;QAAAG,QAAA,EAAC;MAE9C;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CACT,EAEAtE,MAAM,KAAK,SAAS,iBACnB9B,OAAA,CAACf,MAAM;QAAC+G,OAAO,EAAC,QAAQ;QAACS,OAAO,EAAEZ,OAAQ;QAAAE,QAAA,EAAC;MAE3C;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CACT;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACG,CAAC,eAEPpG,OAAA,CAAChB,IAAI;MAAC8G,SAAS,EAAC,eAAe;MAAAC,QAAA,eAC7B/F,OAAA,CAACV,YAAY;QACXoH,MAAM,EACJ1E,WAAW,CAACsC,MAAM,GACdtC,WAAW,CAAC,CAAC,CAAC,GACd,CAACL,GAAG,CAACqC,KAAK,CAAC,CAAC,CAAC,CAAC5C,GAAG,EAAEO,GAAG,CAACqC,KAAK,CAAC,CAAC,CAAC,CAAC3C,GAAG,CACxC;QACDsF,IAAI,EAAE,EAAG;QACTC,KAAK,EAAE;UAAEC,MAAM,EAAE,OAAO;UAAEC,KAAK,EAAE;QAAO,CAAE;QAAAf,QAAA,gBAE1C/F,OAAA,CAACT,SAAS;UACRwH,WAAW,EAAC,iCAA8B;UAC1C9C,GAAG,EAAC;QAAoD;UAAAgC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACzD,CAAC,EAEDpE,WAAW,CAACsC,MAAM,GAAG,CAAC,iBACrBtE,OAAA,CAACN,QAAQ;UAACsH,SAAS,EAAEhF,WAAY;UAACiF,KAAK,EAAC;QAAM;UAAAhB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CACjD,EAGA,CAAA3E,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEoC,QAAQ,MAAK,OAAO,IACzBlC,GAAG,CAACqC,KAAK,CAAC9C,GAAG,CAAC,CAACgG,IAAI,EAAExC,CAAC,kBACpB1E,OAAA,CAACR,MAAM;UAAS2H,QAAQ,EAAE,CAACD,IAAI,CAAC9F,GAAG,EAAE8F,IAAI,CAAC7F,GAAG,CAAE;UAAC+F,IAAI,EAAEzG,QAAS;UAAAoF,QAAA,eAC7D/F,OAAA,CAACP,KAAK;YAAAsG,QAAA,EAAEmB,IAAI,CAACG;UAAQ;YAAApB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ;QAAC,GADnB1B,CAAC;UAAAuB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAEN,CACT,CAAC,EAEHpF,QAAQ,iBACPhB,OAAA,CAAAE,SAAA;UAAA6F,QAAA,gBACE/F,OAAA,CAACR,MAAM;YAAC2H,QAAQ,EAAE,CAACnG,QAAQ,CAACI,GAAG,EAAEJ,QAAQ,CAACK,GAAG,CAAE;YAAC+F,IAAI,EAAEtG,OAAQ;YAAAiF,QAAA,eAC5D/F,OAAA,CAACP,KAAK;cAAAsG,QAAA,EAAC;YAAQ;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACjB,CAAC,eACTpG,OAAA,CAACe,WAAW;YAACC,QAAQ,EAAEA;UAAS;YAAAiF,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC;QAAA,eACnC,CACH;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACW;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACX,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACE,CAAC;AAEhB;AAAC5E,GAAA,CA1PuBD,kBAAkB;AAAA+F,GAAA,GAAlB/F,kBAAkB;AAAA,IAAAD,EAAA,EAAAgG,GAAA;AAAAC,YAAA,CAAAjG,EAAA;AAAAiG,YAAA,CAAAD,GAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}